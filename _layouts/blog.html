---
layout: default
---

<div class="blog-container">
  <div class="blog-sidebar">
    <div class="blog-search">
      <input type="text" id="blog-search" placeholder="Search posts...">
    </div>
    <div class="blog-categories">
      <h3>Categories</h3>
      <ul id="category-list">
        <!-- Categories will be populated dynamically -->
      </ul>
    </div>
    <div class="blog-tags">
      <h3>Tags</h3>
      <div id="tag-cloud">
        <!-- Tags will be populated dynamically -->
      </div>
    </div>
  </div>
  
  <div class="blog-content">
    <div id="blog-posts">
      <!-- Posts will be loaded dynamically -->
    </div>
    <div id="blog-post" class="hidden">
      <!-- Individual post content will be loaded here -->
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // State management
  let state = {
    posts: [],
    currentPost: null,
    filters: {
      search: '',
      category: null,
      tags: []
    }
  };

  // Fetch all posts
  async function fetchPosts() {
    const response = await fetch('/blog/posts.json');
    state.posts = await response.json();
    renderPosts();
    updateCategories();
    updateTags();
  }

  // Render posts based on current filters
  function renderPosts() {
    const filteredPosts = state.posts.filter(post => {
      const matchesSearch = post.title.toLowerCase().includes(state.filters.search.toLowerCase()) ||
                          post.excerpt.toLowerCase().includes(state.filters.search.toLowerCase());
      const matchesCategory = !state.filters.category || post.category === state.filters.category;
      const matchesTags = state.filters.tags.length === 0 || 
                         state.filters.tags.every(tag => post.tags.includes(tag));
      return matchesSearch && matchesCategory && matchesTags;
    });

    const postsContainer = document.getElementById('blog-posts');
    postsContainer.innerHTML = filteredPosts.map(post => `
      <article class="blog-post-card" data-post-id="${post.id}">
        <h2>${post.title}</h2>
        <div class="post-meta">
          <span class="post-date">${new Date(post.date).toLocaleDateString()}</span>
          <span class="post-category">${post.category}</span>
        </div>
        <p>${post.excerpt}</p>
        <div class="post-tags">
          ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
        </div>
        <button class="read-more" onclick="loadPost('${post.id}')">Read More</button>
      </article>
    `).join('');
  }

  // Load individual post
  async function loadPost(postId) {
    const post = state.posts.find(p => p.id === postId);
    if (!post) return;

    state.currentPost = post;
    const postContainer = document.getElementById('blog-post');
    const postsContainer = document.getElementById('blog-posts');

    // Fetch full post content
    const response = await fetch(`/blog/posts/${postId}.html`);
    const content = await response.text();

    postContainer.innerHTML = `
      <article class="full-post">
        <button class="back-button" onclick="showPosts()">‚Üê Back to Posts</button>
        <h1>${post.title}</h1>
        <div class="post-meta">
          <span class="post-date">${new Date(post.date).toLocaleDateString()}</span>
          <span class="post-category">${post.category}</span>
        </div>
        <div class="post-content">${content}</div>
        <div class="post-tags">
          ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
        </div>
      </article>
    `;

    postsContainer.classList.add('hidden');
    postContainer.classList.remove('hidden');
  }

  // Show posts list
  function showPosts() {
    document.getElementById('blog-posts').classList.remove('hidden');
    document.getElementById('blog-post').classList.add('hidden');
    state.currentPost = null;
  }

  // Update categories list
  function updateCategories() {
    const categories = [...new Set(state.posts.map(post => post.category))];
    const categoryList = document.getElementById('category-list');
    categoryList.innerHTML = categories.map(category => `
      <li>
        <button onclick="filterByCategory('${category}')" class="category-button">
          ${category}
        </button>
      </li>
    `).join('');
  }

  // Update tags cloud
  function updateTags() {
    const tags = [...new Set(state.posts.flatMap(post => post.tags))];
    const tagCloud = document.getElementById('tag-cloud');
    tagCloud.innerHTML = tags.map(tag => `
      <span class="tag" onclick="toggleTag('${tag}')">${tag}</span>
    `).join('');
  }

  // Event listeners
  document.getElementById('blog-search').addEventListener('input', (e) => {
    state.filters.search = e.target.value;
    renderPosts();
  });

  // Make functions globally available
  window.loadPost = loadPost;
  window.showPosts = showPosts;
  window.filterByCategory = (category) => {
    state.filters.category = state.filters.category === category ? null : category;
    renderPosts();
  };
  window.toggleTag = (tag) => {
    const index = state.filters.tags.indexOf(tag);
    if (index === -1) {
      state.filters.tags.push(tag);
    } else {
      state.filters.tags.splice(index, 1);
    }
    renderPosts();
  };

  // Initialize
  fetchPosts();
});
</script>

<style>
.blog-container {
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 2rem;
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.blog-sidebar {
  position: sticky;
  top: 2rem;
  height: fit-content;
}

.blog-search input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  margin-bottom: 1rem;
}

.blog-categories, .blog-tags {
  margin-bottom: 2rem;
}

.blog-categories h3, .blog-tags h3 {
  margin-bottom: 1rem;
  color: var(--text-color);
}

.category-button {
  background: none;
  border: none;
  color: var(--text-color);
  cursor: pointer;
  padding: 0.25rem 0;
  text-align: left;
  width: 100%;
}

.category-button:hover {
  color: var(--accent-color);
}

.blog-post-card {
  background: var(--card-bg);
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.post-meta {
  color: var(--text-muted);
  font-size: 0.9rem;
  margin: 0.5rem 0;
}

.post-tags {
  margin-top: 1rem;
}

.tag {
  display: inline-block;
  background: var(--tag-bg);
  color: var(--tag-color);
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.8rem;
  margin-right: 0.5rem;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

.read-more {
  background: var(--accent-color);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  margin-top: 1rem;
}

.read-more:hover {
  background: var(--accent-color-dark);
}

.full-post {
  background: var(--card-bg);
  border-radius: 8px;
  padding: 2rem;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.back-button {
  background: none;
  border: none;
  color: var(--text-color);
  cursor: pointer;
  padding: 0.5rem 0;
  margin-bottom: 1rem;
}

.back-button:hover {
  color: var(--accent-color);
}

.hidden {
  display: none;
}

@media (max-width: 768px) {
  .blog-container {
    grid-template-columns: 1fr;
  }
  
  .blog-sidebar {
    position: static;
  }
}
</style> 